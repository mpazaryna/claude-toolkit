# Example: MOC Mode Output

This shows the expected output format for the `docs/moc/` hierarchy.

## Generated File Structure

```
docs/moc/
├── README.md           # Main entry point
├── features.md         # Feature catalog
├── architecture.md     # Architecture overview
├── components.md       # Component maps
└── decisions.md        # Decision history (if devlog exists)
```

---

## Example: docs/moc/README.md

```markdown
---
title: TaskFlow API - Documentation Hub
type: moc
generated: 2025-11-20
last_updated: 2025-11-20
project: TaskFlow API
version: 2.1.0
---

# TaskFlow API - Documentation Hub

> Last generated: 2025-11-20

## Overview

TaskFlow API is a REST API with real-time WebSocket capabilities for task management and collaboration. Built with Node.js, TypeScript, Express, PostgreSQL, and Redis.

## Quick Navigation

- [Features](./features.md) - What the API does
- [Architecture](./architecture.md) - How it's built
- [Components](./components.md) - Module breakdown
- [Decisions](./decisions.md) - Why it's built this way

## Tech Stack

| Category | Technology |
|----------|------------|
| Runtime | Node.js 20 |
| Language | TypeScript 5.x |
| Framework | Express.js |
| Database | PostgreSQL |
| Cache | Redis |
| Testing | Jest |

## System Architecture

​```mermaid
flowchart TB
    A[Client] --> B[API Gateway]
    B --> C[Auth Service]
    B --> D[Task Service]
    B --> E[Notification Service]
    C --> F[(PostgreSQL)]
    D --> F
    E --> G[(Redis)]
​```

## Key Features

1. **User Authentication** - JWT-based auth with refresh tokens
2. **Task Management** - CRUD with filtering and sorting
3. **Real-time Notifications** - WebSocket push updates

## Getting Started

See the main [README](../../README.md) for setup instructions.

## Development Log

Recent decisions and project evolution:
- [2025-11-18: Auth Implementation](../../docs/devlog/2025-11-18-auth.md)
- [2025-11-15: API Redesign](../../docs/devlog/2025-11-15-api-redesign.md)

---

*Documentation generated by codebase-docs skill (moc mode)*
```

---

## Example: docs/moc/features.md

```markdown
---
title: Feature Catalog
type: moc-features
generated: 2025-11-20
project: TaskFlow API
---

# Feature Catalog

## Core Features

### User Authentication
**Status**: Implemented
**Source**: [src/services/auth-service.ts](../../src/services/auth-service.ts)

JWT-based authentication with refresh token support.

**Capabilities**:
- User registration and login
- Access token (15-min expiry)
- Refresh token (7-day expiry)
- Token validation middleware

**Related Components**: [Auth Service](./components.md#auth-service)

---

### Task Management
**Status**: Implemented
**Source**: [src/services/task-service.ts](../../src/services/task-service.ts)

Full CRUD operations for tasks with advanced filtering.

**Capabilities**:
- Create, read, update, delete tasks
- Filter by status, assignee, date range
- Sort by multiple fields
- Pagination support

**Related Components**: [Task Service](./components.md#task-service)

---

### Real-time Notifications
**Status**: Implemented
**Source**: [src/services/notification-service.ts](../../src/services/notification-service.ts)

WebSocket-based push notifications for task updates.

**Capabilities**:
- Task created/updated/deleted events
- User-specific notification channels
- Reconnection handling

**Related Components**: [Notification Service](./components.md#notification-service)

---

## Feature Dependency Graph

​```mermaid
graph LR
    A[Authentication] --> B[Task Management]
    A --> C[Notifications]
    B --> C
​```

---

*Feature documentation generated by codebase-docs skill (moc mode)*
```

---

## Example: docs/moc/architecture.md

```markdown
---
title: Architecture Overview
type: moc-architecture
generated: 2025-11-20
project: TaskFlow API
---

# Architecture Overview

## System Design

### Layered Architecture

​```mermaid
flowchart TB
    subgraph "API Layer"
        A[Routes]
        B[Middleware]
    end

    subgraph "Service Layer"
        C[Auth Service]
        D[Task Service]
        E[Notification Service]
    end

    subgraph "Data Layer"
        F[Repositories]
        G[(PostgreSQL)]
        H[(Redis)]
    end

    A --> B
    B --> C
    B --> D
    B --> E
    C --> F
    D --> F
    E --> H
    F --> G
​```

### Design Principles

1. **Separation of Concerns** - Routes, services, and data access are distinct layers
2. **Dependency Injection** - Services receive dependencies via constructor
3. **Repository Pattern** - Data access abstracted behind repository interface
4. **Stateless Auth** - JWT tokens enable horizontal scaling

## Technology Choices

| Area | Choice | Rationale |
|------|--------|-----------|
| Database | PostgreSQL | Relational data, ACID, JSONB flexibility |
| Cache | Redis | TTL support, pub/sub for future features |
| Auth | JWT | Stateless, mobile-friendly, scalable |
| Real-time | WebSocket | Bidirectional, low latency |

## Request Flow

​```mermaid
sequenceDiagram
    Client->>Router: HTTP Request
    Router->>AuthMiddleware: Validate JWT
    AuthMiddleware->>Service: Business Logic
    Service->>Repository: Data Access
    Repository->>Database: Query
    Database->>Repository: Results
    Repository->>Service: Data
    Service->>Router: Response
    Router->>Client: HTTP Response
​```

## Key Decisions

See [Decisions](./decisions.md) for detailed ADRs:
- [ADR-001: Hybrid REST + WebSocket](./decisions.md#adr-001)
- [ADR-002: JWT Authentication](./decisions.md#adr-002)
- [ADR-003: PostgreSQL Selection](./decisions.md#adr-003)

---

*Architecture documentation generated by codebase-docs skill (moc mode)*
```

---

## Key Characteristics

1. **Standard Markdown Links** - `[text](./path.md)` format, never wiki-links
2. **Frontmatter** - Every file has YAML frontmatter with dates
3. **Mermaid Diagrams** - Visual architecture, no ASCII art
4. **Cross-linking** - Documents reference each other
5. **Source Links** - Direct links to implementation files
6. **GitHub Compatible** - Renders perfectly on GitHub
